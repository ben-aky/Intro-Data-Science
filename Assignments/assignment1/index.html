<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ben Akyureklier">
<meta name="dcterms.date" content="2025-02-09">

<title>Homework 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="homework-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="homework-1_files/libs/quarto-html/quarto.js"></script>
<script src="homework-1_files/libs/quarto-html/popper.min.js"></script>
<script src="homework-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="homework-1_files/libs/quarto-html/anchor.min.js"></script>
<link href="homework-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="homework-1_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="homework-1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="homework-1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="homework-1_files/libs/bootstrap/bootstrap-ee590355b30e24d7dbf4044bb666b853.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="homework-1_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="homework-1_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="homework-1_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="homework-1_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="homework-1_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="homework-1_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="homework-1_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="homework-1_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="homework-1_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ben Akyureklier </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 9, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>For this assignment, you are going to evaluate modernization theory as laid out in Seymour Martin Lipset’s <a href="https://www-jstor-org.proxygw.wrlc.org/stable/1951731?seq=8">classic article</a> entitled “Some Social Requisites of Democracy: Economic Development and Political Legitimacy.” How classic is this article? According to Google Scholar, this piece has been cited more than 11.5 thousand times!</p>
<p>We are going to use data from V-Dem and modern data viz tools to explore Lipset’s hypothesis that economic modernization is highly correlated with democracy. We have already done this to some extent by looking at the relationship between wealth and the polyarchy score. But we are going to broaden things out by looking at other measures of democracy contained in the V-Dem dataset. Specifically, you will get to choose between the following four measures:</p>
<ul>
<li>liberal democracy (<code>libdem</code>)</li>
<li>participatory democracy (<code>partipdem</code>)</li>
<li>deliberative democracy (<code>delibdem</code>)</li>
<li>egalitarian democracy (<code>egaldem</code>).</li>
</ul>
<p>For measuring modernization we are going to stick with GDP per capita (<code>gdp_pc</code>).</p>
<p>Start by running this code chunk to import all of the packages you will need for this exercise. Then start working through the code and questions below. Feel free to grab relevant code chunks from the slides or the classwork QMD files that we have used in class so far.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-1-make-a-line-chart-showing-country-trends-20-pts" class="level2">
<h2 class="anchored" data-anchor-id="step-1-make-a-line-chart-showing-country-trends-20-pts">Step 1: Make a line chart showing country trends (20 pts)</h2>
<p><em>a) Read in the data from line_chart.csv using <code>read_csv()</code> in an object called <code>line_chart_dta</code>.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>line_chart_dta<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"data/line_chart.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>b) Now use <code>glimpse()</code> to inspect the data. How many rows and columns are in the data frame? Write your answer below the code chunk</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(line_chart_dta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 270
Columns: 8
$ country         &lt;chr&gt; "South Africa", "South Africa", "South Africa", "South…
$ country_text_id &lt;chr&gt; "ZAF", "ZAF", "ZAF", "ZAF", "ZAF", "ZAF", "ZAF", "ZAF"…
$ country_id      &lt;dbl&gt; 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, …
$ year            &lt;dbl&gt; 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, …
$ libdem          &lt;dbl&gt; 0.093, 0.093, 0.093, 0.093, 0.093, 0.093, 0.093, 0.093…
$ partipdem       &lt;dbl&gt; 0.124, 0.124, 0.124, 0.124, 0.124, 0.123, 0.123, 0.132…
$ delibdem        &lt;dbl&gt; 0.130, 0.130, 0.130, 0.130, 0.131, 0.131, 0.131, 0.130…
$ egaldem         &lt;dbl&gt; 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033, 0.033…</code></pre>
</div>
</div>
<p>270 Rows // 8 Columns</p>
<p><em>c) Now click on the data frame in the Environment tab or use <code>View()</code> to scroll through the data frame. What countries, years and variables are in the data frame? What are the measures of democracy?</em></p>
<p>The five countries included are South Africa, Russia, Brazil, India, and China. Years range from 1970 to 2023. There is a country ID variable and a country text ID variable. The other variables are the measures of democracy, libdem- Liberal democracy indicator; partipdem- Participatory democracy indicator; delibdem- Deliberative democracy; egaldem- Egalitarian democracy indicator</p>
<p><em>d) Now choose one of the democracy indicators and visualize it with a line chart using <code>ggplot2</code>. Be sure to specify <code>x =</code>, <code>y =</code> and <code>color =</code> in your aes() call and use <code>geom_line()</code> to create the chart.Add appropriate axis labels, a title and a caption. Now add a colorblind-friendly color map using <code>viridis</code> and a theme.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(line_chart_dta, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> libdem)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span>country)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span> <span class="st">"Liberal Democracy Score by Country"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption=</span> <span class="st">"Source: V-Dem Institute"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">"Year"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">"Democracy Score"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span> <span class="st">"Country"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_grey</span>()<span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option=</span><span class="st">"turbo"</span>, <span class="at">end=</span>.<span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework-1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>e) In a few sentences below, interpret your chart. Describe the levels and trends in democracy scores. Put your answer right below this line in markdown text (DO NOT write your comments in a code chunk!!).</em></p>
<p>Since 1970, China has ranked poorly in liberal democracy score; Brazil has seen a sharp rise in democracy since 1984, while South Africa saw a similar change in 1995; Russia had a brief rise in democracy from the late 80s to late 90s; India started off in 1970 as the “most democratic” of the five nations, but the country has seen a decline in score since 2015.</p>
</section>
<section id="step-2-make-a-column-chart-comparing-regional-levels-20-pts" class="level2">
<h2 class="anchored" data-anchor-id="step-2-make-a-column-chart-comparing-regional-levels-20-pts">Step 2: Make a column chart comparing regional levels (20 pts)</h2>
<p><em>a) Read in the data from column_chart.csv using <code>read_csv()</code> in an object called <code>column_chart_dta</code>. You should see average democracy scores for the countries that you made a line chart for in Step 1.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>column_chart_dta<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"data/column_chart.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>b) View the data frame. Describe briefly what you see, e.g.&nbsp;number of rows, columns and how the countries rank in terms of one of the democracy scores.</em></p>
<p>There are 5 rows and 5 columns. Brazil and India are ranked at the top of all democracy scoring metrics, South Africa is always 3rd, and Russia then China follow for each indicator.</p>
<p><em>c) Use <code>ggplot()</code> and <code>geom_col()</code> to visualize one of the democracy measures with a column chart (you can use the same measure as in Step 1 or a different one). Use <code>fct_reorder()</code> to arrange the columns in order of the y-axis values. Make sure to add appropriate axis labels, a title and a caption. Change the fill color and add a theme to spruce it up a bit. Remember that these are averages over the same number of years as the line chart you made in Step 1</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(column_chart_dta, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(country, libdem), <span class="at">y =</span> libdem)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span> <span class="st">"Average Liberal Democracy Score by Country"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption=</span> <span class="st">"Source: V-Dem Institute"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">"Country"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">"Democracy Score"</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework-1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>d) Interpret your column chart. Does the evidence in the column chart roughly match what you saw in the line chart above?</em></p>
<p>The results are mostly the same, with Brazil being at the top and Russia then China being drastically lower in democracy score when compared to the other countries. The only difference would be India’s and South Africa’s position in the charts, with the line graph showing South Africa with Brazil at the top, while the column chart suggests South Africa has a noticably lower democracy score than Brazil and India.</p>
</section>
<section id="step-3-make-a-scatter-plot-20-pts" class="level2">
<h2 class="anchored" data-anchor-id="step-3-make-a-scatter-plot-20-pts">Step 3: Make a scatter plot (20 pts)</h2>
<p><em>a) Load the scatter plot data with <code>read_csv()</code>from <code>scatter_plot.csv</code>, storing the data in an object called <code>scatter_plot_dta</code>. Then glimpse or view the data and describe briefly what you see. Note that the values you see are country averages for the variables over the period 2010 - 2019.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>scatter_plot_dta<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"data/scatter_plot.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>b) Now build a scatter plot with <code>ggplot2</code> using these data. Put GDP on the x-axis and one of the measures of democracy on the y-axis and color the points by region. Stretch the x-axis on a log scale and use the <code>scales</code> package to add a prefix and suffix to the x-axis numbers to indicate that they are dollar figures. Add appropriate labels and a <code>viridis</code> color map and add your favorite theme. Note that you will get some warnings about a few missing data points, so try setting <code>warning: false</code> at the top of the code chunk with the hash pipe (#|) operator.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> scatter_plot_dta, <span class="fu">aes</span>(<span class="at">x =</span> gdp_pc, <span class="at">y =</span> libdem)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>region)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">prefix =</span> <span class="st">"$"</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span> <span class="st">"Wealth and Democracy Score by Region"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption=</span> <span class="st">"Source: V-Dem Institute"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">"GDP_PC"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">"Democracy Score"</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span> <span class="st">"Region"</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option=</span><span class="st">"turbo"</span>, <span class="at">end=</span>.<span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework-1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>c) Next add a trend line with <code>geom_smooth()</code> preferably with a linear model (method = “lm”). Note that you will get some warnings about missing data points and a message about the linear model. Try setting <code>warning: false</code> at the top of the code chunk with the hash pipe (#|) operator.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> scatter_plot_dta, <span class="fu">aes</span>(<span class="at">x =</span> gdp_pc, <span class="at">y =</span> libdem)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>region)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">prefix =</span> <span class="st">"$"</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span> <span class="st">"Wealth and Democracy Score by Region"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption=</span> <span class="st">"Source: V-Dem Institute"</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">"GDP_PC"</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">"Democracy Score"</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span> <span class="st">"Region"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option=</span><span class="st">"turbo"</span>, <span class="at">end=</span>.<span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework-1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-4-additional-tasks-20-pts" class="level2">
<h2 class="anchored" data-anchor-id="step-4-additional-tasks-20-pts">Step 4: Additional Tasks (20 pts)</h2>
<p><em>a) Facet wrap your scatter plot by region.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(paletteer)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> scatter_plot_dta, <span class="fu">aes</span>(<span class="at">x =</span> gdp_pc, <span class="at">y =</span> libdem)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>region) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">prefix =</span> <span class="st">"$"</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)) <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span> <span class="st">"Wealth and Democracy Score by Region"</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption=</span> <span class="st">"Source: V-Dem Institute"</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">"GDP_PC"</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span> <span class="st">"Democracy Score"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework-1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>b) Remove the <code>facet_wrap()</code> call and display the relationship for one region and use <code>geom_text()</code> to label your points.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>scatter_plot_dta <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"The West"</span>) <span class="sc">|&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdp_pc, <span class="at">y =</span> libdem)) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">vjust =</span> <span class="fl">2.1</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">prefix =</span> <span class="st">"$"</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span> <span class="st">"Wealth and Democracy Score of The West"</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span> <span class="st">"Source: V-Dem Institute"</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span> <span class="st">"GDP_PC"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span> <span class="st">"Democracy Score"</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="homework-1_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>c) Remove the text labels and make your scatter plot interactive using <code>ggplotly()</code>. Make sure that your tooltip includes the information that you want to display to the user.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>libdem_scatter<span class="ot">&lt;-</span>scatter_plot_dta <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"The West"</span>) <span class="sc">|&gt;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdp_pc, <span class="at">y =</span> libdem)) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> country)<span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_number</span>(<span class="at">prefix =</span> <span class="st">"$"</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">title=</span> <span class="st">"Wealth and Democracy Score of The West"</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption=</span> <span class="st">"Source: V-Dem Institute"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span> <span class="st">"GDP_PC"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span> <span class="st">"Democracy Score"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(libdem_scatter, <span class="at">tootip =</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"libdem"</span>, <span class="st">"gdp_pc"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-48cdc3971af629290479" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-48cdc3971af629290479">{"x":{"data":[{"x":[1.6711385793255065,1.6381696583885421,1.6180480967120927,1.6526031090414779,1.4567288059816805,1.6527915266995226,1.5885786865501383,1.5891964692957514,1.6339539878982625,1.3904157618324435,1.6833955953502961,1.7567022741684069,1.518591579526769,1.914498650081168,1.516352892219635,1.6660056977564082,1.5445455057247308,1.7673525532251293,1.4229770198109772,1.5191136416451996,1.660966927965009,1.7310864981207386,1.5856750037868879,1.7502753715419304],"y":[0.82989999999999997,0.79770000000000008,0.83860000000000001,0.75819999999999999,0.73399999999999999,0.89260000000000006,0.83909999999999996,0.81699999999999995,0.85370000000000001,0.79590000000000005,0.78810000000000002,0.82699999999999996,0.78510000000000002,0.79660000000000009,0.59970000000000001,0.83189999999999997,0.83949999999999991,0.85999999999999999,0.8357,0.78949999999999998,0.8821,0.86109999999999998,0.79860000000000009,0.81799999999999995],"text":["country: Australia<br />gdp_pc: 46.8963<br />libdem: 0.8299","country: Austria<br />gdp_pc: 43.4680<br />libdem: 0.7977","country: Belgium<br />gdp_pc: 41.5000<br />libdem: 0.8386","country: Canada<br />gdp_pc: 44.9369<br />libdem: 0.7582","country: Cyprus<br />gdp_pc: 28.6239<br />libdem: 0.7340","country: Denmark<br />gdp_pc: 44.9564<br />libdem: 0.8926","country: Finland<br />gdp_pc: 38.7774<br />libdem: 0.8391","country: France<br />gdp_pc: 38.8326<br />libdem: 0.8170","country: Germany<br />gdp_pc: 43.0481<br />libdem: 0.8537","country: Greece<br />gdp_pc: 24.5706<br />libdem: 0.7959","country: Iceland<br />gdp_pc: 48.2387<br />libdem: 0.7881","country: Ireland<br />gdp_pc: 57.1087<br />libdem: 0.8270","country: Italy<br />gdp_pc: 33.0059<br />libdem: 0.7851","country: Luxembourg<br />gdp_pc: 82.1294<br />libdem: 0.7966","country: Malta<br />gdp_pc: 32.8362<br />libdem: 0.5997","country: Netherlands<br />gdp_pc: 46.3453<br />libdem: 0.8319","country: New Zealand<br />gdp_pc: 35.0385<br />libdem: 0.8395","country: Norway<br />gdp_pc: 58.5265<br />libdem: 0.8600","country: Portugal<br />gdp_pc: 26.4836<br />libdem: 0.8357","country: Spain<br />gdp_pc: 33.0456<br />libdem: 0.7895","country: Sweden<br />gdp_pc: 45.8107<br />libdem: 0.8821","country: Switzerland<br />gdp_pc: 53.8377<br />libdem: 0.8611","country: United Kingdom<br />gdp_pc: 38.5190<br />libdem: 0.7986","country: United States of America<br />gdp_pc: 56.2698<br />libdem: 0.8180"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.3904157618324435,1.3970497224431868,1.4036836830539303,1.4103176436646736,1.4169516042754169,1.4235855648861602,1.4302195254969037,1.436853486107647,1.4434874467183902,1.4501214073291337,1.456755367939877,1.4633893285506203,1.4700232891613636,1.4766572497721071,1.4832912103828504,1.4899251709935937,1.4965591316043372,1.5031930922150805,1.5098270528258237,1.5164610134365673,1.5230949740473105,1.5297289346580538,1.5363628952687973,1.5429968558795406,1.5496308164902839,1.5562647771010272,1.5628987377117707,1.569532698322514,1.5761666589332572,1.5828006195440008,1.589434580154744,1.5960685407654873,1.6027025013762306,1.6093364619869741,1.6159704225977174,1.6226043832084607,1.6292383438192042,1.6358723044299475,1.6425062650406907,1.649140225651434,1.6557741862621775,1.6624081468729208,1.6690421074836641,1.6756760680944076,1.6823100287051509,1.6889439893158942,1.6955779499266375,1.702211910537381,1.7088458711481243,1.7154798317588675,1.722113792369611,1.7287477529803543,1.7353817135910976,1.7420156742018409,1.7486496348125844,1.7552835954233277,1.7619175560340712,1.7685515166448145,1.7751854772555578,1.781819437866301,1.7884533984770443,1.7950873590877878,1.8017213196985311,1.8083552803092746,1.8149892409200179,1.8216232015307612,1.8282571621415045,1.834891122752248,1.8415250833629913,1.8481590439737345,1.854793004584478,1.8614269651952213,1.8680609258059646,1.8746948864167079,1.8813288470274514,1.8879628076381947,1.8945967682489382,1.9012307288596815,1.9078646894704248,1.914498650081168],"y":[0.77492809852295397,0.77596788030963959,0.77700766209632532,0.77804744388301095,0.77908722566969668,0.78012700745638242,0.78116678924306804,0.78220657102975377,0.7832463528164394,0.78428613460312513,0.78532591638981075,0.78636569817649649,0.78740547996318222,0.78844526174986784,0.78948504353655358,0.7905248253232392,0.79156460710992493,0.79260438889661056,0.79364417068329629,0.79468395246998202,0.79572373425666765,0.79676351604335338,0.79780329783003912,0.79884307961672474,0.79988286140341036,0.8009226431900961,0.80196242497678183,0.80300220676346745,0.80404198855015308,0.80508177033683881,0.80612155212352454,0.80716133391021017,0.8082011156968959,0.80924089748358163,0.81028067927026726,0.81132046105695288,0.81236024284363872,0.81340002463032435,0.81443980641700997,0.81547958820369559,0.81651936999038144,0.81755915177706706,0.81859893356375268,0.81963871535043842,0.82067849713712415,0.82171827892380978,0.8227580607104954,0.82379784249718124,0.82483762428386687,0.82587740607055249,0.82691718785723822,0.82795696964392396,0.82899675143060958,0.8300365332172952,0.83107631500398105,0.83211609679066667,0.83315587857735229,0.83419566036403803,0.83523544215072376,0.83627522393740938,0.83731500572409501,0.83835478751078085,0.83939456929746648,0.8404343510841521,0.84147413287083783,0.84251391465752357,0.84355369644420919,0.84459347823089481,0.84563326001758055,0.84667304180426628,0.8477128235909519,0.84875260537763764,0.84979238716432337,0.85083216895100899,0.85187195073769462,0.85291173252438035,0.85395151431106608,0.85499129609775171,0.85603107788443744,0.85707085967112318],"text":["gdp_pc: 1.390416<br />libdem: 0.7749281","gdp_pc: 1.397050<br />libdem: 0.7759679","gdp_pc: 1.403684<br />libdem: 0.7770077","gdp_pc: 1.410318<br />libdem: 0.7780474","gdp_pc: 1.416952<br />libdem: 0.7790872","gdp_pc: 1.423586<br />libdem: 0.7801270","gdp_pc: 1.430220<br />libdem: 0.7811668","gdp_pc: 1.436853<br />libdem: 0.7822066","gdp_pc: 1.443487<br />libdem: 0.7832464","gdp_pc: 1.450121<br />libdem: 0.7842861","gdp_pc: 1.456755<br />libdem: 0.7853259","gdp_pc: 1.463389<br />libdem: 0.7863657","gdp_pc: 1.470023<br />libdem: 0.7874055","gdp_pc: 1.476657<br />libdem: 0.7884453","gdp_pc: 1.483291<br />libdem: 0.7894850","gdp_pc: 1.489925<br />libdem: 0.7905248","gdp_pc: 1.496559<br />libdem: 0.7915646","gdp_pc: 1.503193<br />libdem: 0.7926044","gdp_pc: 1.509827<br />libdem: 0.7936442","gdp_pc: 1.516461<br />libdem: 0.7946840","gdp_pc: 1.523095<br />libdem: 0.7957237","gdp_pc: 1.529729<br />libdem: 0.7967635","gdp_pc: 1.536363<br />libdem: 0.7978033","gdp_pc: 1.542997<br />libdem: 0.7988431","gdp_pc: 1.549631<br />libdem: 0.7998829","gdp_pc: 1.556265<br />libdem: 0.8009226","gdp_pc: 1.562899<br />libdem: 0.8019624","gdp_pc: 1.569533<br />libdem: 0.8030022","gdp_pc: 1.576167<br />libdem: 0.8040420","gdp_pc: 1.582801<br />libdem: 0.8050818","gdp_pc: 1.589435<br />libdem: 0.8061216","gdp_pc: 1.596069<br />libdem: 0.8071613","gdp_pc: 1.602703<br />libdem: 0.8082011","gdp_pc: 1.609336<br />libdem: 0.8092409","gdp_pc: 1.615970<br />libdem: 0.8102807","gdp_pc: 1.622604<br />libdem: 0.8113205","gdp_pc: 1.629238<br />libdem: 0.8123602","gdp_pc: 1.635872<br />libdem: 0.8134000","gdp_pc: 1.642506<br />libdem: 0.8144398","gdp_pc: 1.649140<br />libdem: 0.8154796","gdp_pc: 1.655774<br />libdem: 0.8165194","gdp_pc: 1.662408<br />libdem: 0.8175592","gdp_pc: 1.669042<br />libdem: 0.8185989","gdp_pc: 1.675676<br />libdem: 0.8196387","gdp_pc: 1.682310<br />libdem: 0.8206785","gdp_pc: 1.688944<br />libdem: 0.8217183","gdp_pc: 1.695578<br />libdem: 0.8227581","gdp_pc: 1.702212<br />libdem: 0.8237978","gdp_pc: 1.708846<br />libdem: 0.8248376","gdp_pc: 1.715480<br />libdem: 0.8258774","gdp_pc: 1.722114<br />libdem: 0.8269172","gdp_pc: 1.728748<br />libdem: 0.8279570","gdp_pc: 1.735382<br />libdem: 0.8289968","gdp_pc: 1.742016<br />libdem: 0.8300365","gdp_pc: 1.748650<br />libdem: 0.8310763","gdp_pc: 1.755284<br />libdem: 0.8321161","gdp_pc: 1.761918<br />libdem: 0.8331559","gdp_pc: 1.768552<br />libdem: 0.8341957","gdp_pc: 1.775185<br />libdem: 0.8352354","gdp_pc: 1.781819<br />libdem: 0.8362752","gdp_pc: 1.788453<br />libdem: 0.8373150","gdp_pc: 1.795087<br />libdem: 0.8383548","gdp_pc: 1.801721<br />libdem: 0.8393946","gdp_pc: 1.808355<br />libdem: 0.8404344","gdp_pc: 1.814989<br />libdem: 0.8414741","gdp_pc: 1.821623<br />libdem: 0.8425139","gdp_pc: 1.828257<br />libdem: 0.8435537","gdp_pc: 1.834891<br />libdem: 0.8445935","gdp_pc: 1.841525<br />libdem: 0.8456333","gdp_pc: 1.848159<br />libdem: 0.8466730","gdp_pc: 1.854793<br />libdem: 0.8477128","gdp_pc: 1.861427<br />libdem: 0.8487526","gdp_pc: 1.868061<br />libdem: 0.8497924","gdp_pc: 1.874695<br />libdem: 0.8508322","gdp_pc: 1.881329<br />libdem: 0.8518720","gdp_pc: 1.887963<br />libdem: 0.8529117","gdp_pc: 1.894597<br />libdem: 0.8539515","gdp_pc: 1.901231<br />libdem: 0.8549913","gdp_pc: 1.907865<br />libdem: 0.8560311","gdp_pc: 1.914499<br />libdem: 0.8570709"],"type":"scatter","mode":"lines","name":"fitted values","line":{"width":3.0236220472440949,"color":"rgba(51,102,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.3904157618324435,1.3970497224431868,1.4036836830539303,1.4103176436646736,1.4169516042754169,1.4235855648861602,1.4302195254969037,1.436853486107647,1.4434874467183902,1.4501214073291337,1.456755367939877,1.4633893285506203,1.4700232891613636,1.4766572497721071,1.4832912103828504,1.4899251709935937,1.4965591316043372,1.5031930922150805,1.5098270528258237,1.5164610134365673,1.5230949740473105,1.5297289346580538,1.5363628952687973,1.5429968558795406,1.5496308164902839,1.5562647771010272,1.5628987377117707,1.569532698322514,1.5761666589332572,1.5828006195440008,1.589434580154744,1.5960685407654873,1.6027025013762306,1.6093364619869741,1.6159704225977174,1.6226043832084607,1.6292383438192042,1.6358723044299475,1.6425062650406907,1.649140225651434,1.6557741862621775,1.6624081468729208,1.6690421074836641,1.6756760680944076,1.6823100287051509,1.6889439893158942,1.6955779499266375,1.702211910537381,1.7088458711481243,1.7154798317588675,1.722113792369611,1.7287477529803543,1.7353817135910976,1.7420156742018409,1.7486496348125844,1.7552835954233277,1.7619175560340712,1.7685515166448145,1.7751854772555578,1.781819437866301,1.7884533984770443,1.7950873590877878,1.8017213196985311,1.8083552803092746,1.8149892409200179,1.8216232015307612,1.8282571621415045,1.834891122752248,1.8415250833629913,1.8481590439737345,1.854793004584478,1.8614269651952213,1.8680609258059646,1.8746948864167079,1.8813288470274514,1.8879628076381947,1.8945967682489382,1.9012307288596815,1.9078646894704248,1.914498650081168,1.914498650081168,1.914498650081168,1.9078646894704248,1.9012307288596815,1.8945967682489382,1.8879628076381947,1.8813288470274514,1.8746948864167079,1.8680609258059646,1.8614269651952213,1.854793004584478,1.8481590439737345,1.8415250833629913,1.834891122752248,1.8282571621415045,1.8216232015307612,1.8149892409200179,1.8083552803092746,1.8017213196985311,1.7950873590877878,1.7884533984770443,1.781819437866301,1.7751854772555578,1.7685515166448145,1.7619175560340712,1.7552835954233277,1.7486496348125844,1.7420156742018409,1.7353817135910976,1.7287477529803543,1.722113792369611,1.7154798317588675,1.7088458711481243,1.702211910537381,1.6955779499266375,1.6889439893158942,1.6823100287051509,1.6756760680944076,1.6690421074836641,1.6624081468729208,1.6557741862621775,1.649140225651434,1.6425062650406907,1.6358723044299475,1.6292383438192042,1.6226043832084607,1.6159704225977174,1.6093364619869741,1.6027025013762306,1.5960685407654873,1.589434580154744,1.5828006195440008,1.5761666589332572,1.569532698322514,1.5628987377117707,1.5562647771010272,1.5496308164902839,1.5429968558795406,1.5363628952687973,1.5297289346580538,1.5230949740473105,1.5164610134365673,1.5098270528258237,1.5031930922150805,1.4965591316043372,1.4899251709935937,1.4832912103828504,1.4766572497721071,1.4700232891613636,1.4633893285506203,1.456755367939877,1.4501214073291337,1.4434874467183902,1.436853486107647,1.4302195254969037,1.4235855648861602,1.4169516042754169,1.4103176436646736,1.4036836830539303,1.3970497224431868,1.3904157618324435,1.3904157618324435],"y":[0.72179534307385751,0.72404459268686738,0.72628628776314086,0.72851987830904807,0.73074476390092025,0.73296028837614224,0.73516573394572482,0.73736031467662611,0.739543169293292,0.74171335325198917,0.74386983004978557,0.74601146174414812,0.74813699868123817,0.75024506846384953,0.75233416423694344,0.75440263243402639,0.75644866021591317,0.75847026294988573,0.76046527222694371,0.76243132510176126,0.76436585546559022,0.76626608872325352,0.76812904123008541,0.76995152622959639,0.77173016827772623,0.77346142828465436,0.77514164126930918,0.77676706860813338,0.77833396587002146,0.77983866619013931,0.78127767753548294,0.78264779024802578,0.78394618914669656,0.7851705625922768,0.78631919971766373,0.78739106692199068,0.78838585597495836,0.78930399863975476,0.79014664622543518,0.79091561628555729,0.79161331206378605,0.79224262264614109,0.79280681279446774,0.79330941112370279,0.79375410393882007,0.79414464010199259,0.79448475019684262,0.79477808133908256,0.79502814745700823,0.79523829380444389,0.79541167384832767,0.79555123641317649,0.79565972096559445,0.79573965908896416,0.7957933804538323,0.79582302187668563,0.7958305383417984,0.79581771511635524,0.79578618030826742,0.79573741739658288,0.79567277740818299,0.79559349052584505,0.79550067699683469,0.79539535727310751,0.79527846135856928,0.79515083736968473,0.79501325933632527,0.79486643428274384,0.79471100863604316,0.79454757401304255,0.79437667243725885,0.79419880103667961,0.79401441627079106,0.79382393773240167,0.79362775156649024,0.79342621354486809,0.79321965183200849,0.79300836947408637,0.79279264664013438,0.79257274264130217,0.79257274264130217,0.92156897670094418,0.9192695091287405,0.91697422272141704,0.91468337679012368,0.91239725150389261,0.910116149908899,0.90784040016961631,0.90557035805785568,0.90330640971859566,0.90104897474464496,0.89879850959549001,0.89655551139911793,0.89432052217904578,0.8920941335520931,0.88987699194536241,0.88766980438310639,0.88547334489519669,0.88328846159809826,0.88111608449571666,0.87895723404000703,0.87681303047823589,0.8746847039931801,0.87257360561172082,0.87048121881290619,0.86840917170464771,0.8663592495541298,0.86433340734562625,0.86233378189562471,0.86036270287467143,0.85842270186614877,0.85651651833666109,0.8546471011107255,0.85281760365527992,0.85103137122414818,0.84929191774562696,0.84760289033542824,0.84596801957717405,0.84439105433303763,0.84287568090799303,0.84142542791697683,0.8400435601218339,0.83873296660858476,0.83749605062089394,0.83633462971231909,0.83524985519191508,0.83424215882287078,0.83331123237488647,0.83245604224709524,0.83167487757239456,0.83096542671156615,0.83032487448353831,0.82975001123028469,0.82923734491880152,0.82878320868425448,0.82838385809553783,0.8280355545290945,0.82773463300385308,0.82747755442999282,0.82726094336345324,0.82708161304774508,0.82693657983820279,0.82682306913964887,0.82673851484333538,0.8266805540039367,0.82664701821245201,0.82663592283616372,0.82664545503588616,0.82667396124512627,0.82671993460884485,0.82678200272983593,0.82685891595426109,0.82694953633958679,0.82705282738288144,0.82716784454041126,0.82729372653662259,0.82742968743847312,0.82757500945697382,0.82772903642950979,0.8278911679324118,0.82806085397205043,0.72179534307385751],"text":["gdp_pc: 1.390416<br />libdem: 0.7749281","gdp_pc: 1.397050<br />libdem: 0.7759679","gdp_pc: 1.403684<br />libdem: 0.7770077","gdp_pc: 1.410318<br />libdem: 0.7780474","gdp_pc: 1.416952<br />libdem: 0.7790872","gdp_pc: 1.423586<br />libdem: 0.7801270","gdp_pc: 1.430220<br />libdem: 0.7811668","gdp_pc: 1.436853<br />libdem: 0.7822066","gdp_pc: 1.443487<br />libdem: 0.7832464","gdp_pc: 1.450121<br />libdem: 0.7842861","gdp_pc: 1.456755<br />libdem: 0.7853259","gdp_pc: 1.463389<br />libdem: 0.7863657","gdp_pc: 1.470023<br />libdem: 0.7874055","gdp_pc: 1.476657<br />libdem: 0.7884453","gdp_pc: 1.483291<br />libdem: 0.7894850","gdp_pc: 1.489925<br />libdem: 0.7905248","gdp_pc: 1.496559<br />libdem: 0.7915646","gdp_pc: 1.503193<br />libdem: 0.7926044","gdp_pc: 1.509827<br />libdem: 0.7936442","gdp_pc: 1.516461<br />libdem: 0.7946840","gdp_pc: 1.523095<br />libdem: 0.7957237","gdp_pc: 1.529729<br />libdem: 0.7967635","gdp_pc: 1.536363<br />libdem: 0.7978033","gdp_pc: 1.542997<br />libdem: 0.7988431","gdp_pc: 1.549631<br />libdem: 0.7998829","gdp_pc: 1.556265<br />libdem: 0.8009226","gdp_pc: 1.562899<br />libdem: 0.8019624","gdp_pc: 1.569533<br />libdem: 0.8030022","gdp_pc: 1.576167<br />libdem: 0.8040420","gdp_pc: 1.582801<br />libdem: 0.8050818","gdp_pc: 1.589435<br />libdem: 0.8061216","gdp_pc: 1.596069<br />libdem: 0.8071613","gdp_pc: 1.602703<br />libdem: 0.8082011","gdp_pc: 1.609336<br />libdem: 0.8092409","gdp_pc: 1.615970<br />libdem: 0.8102807","gdp_pc: 1.622604<br />libdem: 0.8113205","gdp_pc: 1.629238<br />libdem: 0.8123602","gdp_pc: 1.635872<br />libdem: 0.8134000","gdp_pc: 1.642506<br />libdem: 0.8144398","gdp_pc: 1.649140<br />libdem: 0.8154796","gdp_pc: 1.655774<br />libdem: 0.8165194","gdp_pc: 1.662408<br />libdem: 0.8175592","gdp_pc: 1.669042<br />libdem: 0.8185989","gdp_pc: 1.675676<br />libdem: 0.8196387","gdp_pc: 1.682310<br />libdem: 0.8206785","gdp_pc: 1.688944<br />libdem: 0.8217183","gdp_pc: 1.695578<br />libdem: 0.8227581","gdp_pc: 1.702212<br />libdem: 0.8237978","gdp_pc: 1.708846<br />libdem: 0.8248376","gdp_pc: 1.715480<br />libdem: 0.8258774","gdp_pc: 1.722114<br />libdem: 0.8269172","gdp_pc: 1.728748<br />libdem: 0.8279570","gdp_pc: 1.735382<br />libdem: 0.8289968","gdp_pc: 1.742016<br />libdem: 0.8300365","gdp_pc: 1.748650<br />libdem: 0.8310763","gdp_pc: 1.755284<br />libdem: 0.8321161","gdp_pc: 1.761918<br />libdem: 0.8331559","gdp_pc: 1.768552<br />libdem: 0.8341957","gdp_pc: 1.775185<br />libdem: 0.8352354","gdp_pc: 1.781819<br />libdem: 0.8362752","gdp_pc: 1.788453<br />libdem: 0.8373150","gdp_pc: 1.795087<br />libdem: 0.8383548","gdp_pc: 1.801721<br />libdem: 0.8393946","gdp_pc: 1.808355<br />libdem: 0.8404344","gdp_pc: 1.814989<br />libdem: 0.8414741","gdp_pc: 1.821623<br />libdem: 0.8425139","gdp_pc: 1.828257<br />libdem: 0.8435537","gdp_pc: 1.834891<br />libdem: 0.8445935","gdp_pc: 1.841525<br />libdem: 0.8456333","gdp_pc: 1.848159<br />libdem: 0.8466730","gdp_pc: 1.854793<br />libdem: 0.8477128","gdp_pc: 1.861427<br />libdem: 0.8487526","gdp_pc: 1.868061<br />libdem: 0.8497924","gdp_pc: 1.874695<br />libdem: 0.8508322","gdp_pc: 1.881329<br />libdem: 0.8518720","gdp_pc: 1.887963<br />libdem: 0.8529117","gdp_pc: 1.894597<br />libdem: 0.8539515","gdp_pc: 1.901231<br />libdem: 0.8549913","gdp_pc: 1.907865<br />libdem: 0.8560311","gdp_pc: 1.914499<br />libdem: 0.8570709","gdp_pc: 1.914499<br />libdem: 0.8570709","gdp_pc: 1.914499<br />libdem: 0.8570709","gdp_pc: 1.907865<br />libdem: 0.8560311","gdp_pc: 1.901231<br />libdem: 0.8549913","gdp_pc: 1.894597<br />libdem: 0.8539515","gdp_pc: 1.887963<br />libdem: 0.8529117","gdp_pc: 1.881329<br />libdem: 0.8518720","gdp_pc: 1.874695<br />libdem: 0.8508322","gdp_pc: 1.868061<br />libdem: 0.8497924","gdp_pc: 1.861427<br />libdem: 0.8487526","gdp_pc: 1.854793<br />libdem: 0.8477128","gdp_pc: 1.848159<br />libdem: 0.8466730","gdp_pc: 1.841525<br />libdem: 0.8456333","gdp_pc: 1.834891<br />libdem: 0.8445935","gdp_pc: 1.828257<br />libdem: 0.8435537","gdp_pc: 1.821623<br />libdem: 0.8425139","gdp_pc: 1.814989<br />libdem: 0.8414741","gdp_pc: 1.808355<br />libdem: 0.8404344","gdp_pc: 1.801721<br />libdem: 0.8393946","gdp_pc: 1.795087<br />libdem: 0.8383548","gdp_pc: 1.788453<br />libdem: 0.8373150","gdp_pc: 1.781819<br />libdem: 0.8362752","gdp_pc: 1.775185<br />libdem: 0.8352354","gdp_pc: 1.768552<br />libdem: 0.8341957","gdp_pc: 1.761918<br />libdem: 0.8331559","gdp_pc: 1.755284<br />libdem: 0.8321161","gdp_pc: 1.748650<br />libdem: 0.8310763","gdp_pc: 1.742016<br />libdem: 0.8300365","gdp_pc: 1.735382<br />libdem: 0.8289968","gdp_pc: 1.728748<br />libdem: 0.8279570","gdp_pc: 1.722114<br />libdem: 0.8269172","gdp_pc: 1.715480<br />libdem: 0.8258774","gdp_pc: 1.708846<br />libdem: 0.8248376","gdp_pc: 1.702212<br />libdem: 0.8237978","gdp_pc: 1.695578<br />libdem: 0.8227581","gdp_pc: 1.688944<br />libdem: 0.8217183","gdp_pc: 1.682310<br />libdem: 0.8206785","gdp_pc: 1.675676<br />libdem: 0.8196387","gdp_pc: 1.669042<br />libdem: 0.8185989","gdp_pc: 1.662408<br />libdem: 0.8175592","gdp_pc: 1.655774<br />libdem: 0.8165194","gdp_pc: 1.649140<br />libdem: 0.8154796","gdp_pc: 1.642506<br />libdem: 0.8144398","gdp_pc: 1.635872<br />libdem: 0.8134000","gdp_pc: 1.629238<br />libdem: 0.8123602","gdp_pc: 1.622604<br />libdem: 0.8113205","gdp_pc: 1.615970<br />libdem: 0.8102807","gdp_pc: 1.609336<br />libdem: 0.8092409","gdp_pc: 1.602703<br />libdem: 0.8082011","gdp_pc: 1.596069<br />libdem: 0.8071613","gdp_pc: 1.589435<br />libdem: 0.8061216","gdp_pc: 1.582801<br />libdem: 0.8050818","gdp_pc: 1.576167<br />libdem: 0.8040420","gdp_pc: 1.569533<br />libdem: 0.8030022","gdp_pc: 1.562899<br />libdem: 0.8019624","gdp_pc: 1.556265<br />libdem: 0.8009226","gdp_pc: 1.549631<br />libdem: 0.7998829","gdp_pc: 1.542997<br />libdem: 0.7988431","gdp_pc: 1.536363<br />libdem: 0.7978033","gdp_pc: 1.529729<br />libdem: 0.7967635","gdp_pc: 1.523095<br />libdem: 0.7957237","gdp_pc: 1.516461<br />libdem: 0.7946840","gdp_pc: 1.509827<br />libdem: 0.7936442","gdp_pc: 1.503193<br />libdem: 0.7926044","gdp_pc: 1.496559<br />libdem: 0.7915646","gdp_pc: 1.489925<br />libdem: 0.7905248","gdp_pc: 1.483291<br />libdem: 0.7894850","gdp_pc: 1.476657<br />libdem: 0.7884453","gdp_pc: 1.470023<br />libdem: 0.7874055","gdp_pc: 1.463389<br />libdem: 0.7863657","gdp_pc: 1.456755<br />libdem: 0.7853259","gdp_pc: 1.450121<br />libdem: 0.7842861","gdp_pc: 1.443487<br />libdem: 0.7832464","gdp_pc: 1.436853<br />libdem: 0.7822066","gdp_pc: 1.430220<br />libdem: 0.7811668","gdp_pc: 1.423586<br />libdem: 0.7801270","gdp_pc: 1.416952<br />libdem: 0.7790872","gdp_pc: 1.410318<br />libdem: 0.7780474","gdp_pc: 1.403684<br />libdem: 0.7770077","gdp_pc: 1.397050<br />libdem: 0.7759679","gdp_pc: 1.390416<br />libdem: 0.7749281","gdp_pc: 1.390416<br />libdem: 0.7749281"],"type":"scatter","mode":"lines","line":{"width":3.0236220472440949,"color":"transparent","dash":"solid"},"fill":"toself","fillcolor":"rgba(153,153,153,0.4)","hoveron":"points","hoverinfo":"x+y","showlegend":false,"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":43.762557077625573,"r":7.3059360730593621,"b":40.182648401826491,"l":43.105022831050235},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Wealth and Democracy Score of The West","font":{"color":"rgba(0,0,0,1)","family":"","size":17.534246575342465},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[1.3642116174200074,1.9407027944936042],"tickmode":"array","ticktext":["$30k","$50k","$70k"],"tickvals":[1.4771212547196624,1.6989700043360187,1.8450980400142569],"categoryorder":"array","categoryarray":["$30k","$50k","$70k"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"GDP_PC","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.58360655116495286,0.93766242553599133],"tickmode":"array","ticktext":["0.6","0.7","0.8","0.9"],"tickvals":[0.60000000000000009,0.70000000000000007,0.80000000000000004,0.90000000000000013],"categoryorder":"array","categoryarray":["0.6","0.7","0.8","0.9"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"Democracy Score","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"209429cdd39":{"label":{},"x":{},"y":{},"type":"scatter"},"2096fbed9dc":{"label":{},"x":{},"y":{}}},"cur_data":"209429cdd39","visdat":{"209429cdd39":["function (y) ","x"],"2096fbed9dc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="step-5-interpretation-10-pts" class="level2">
<h2 class="anchored" data-anchor-id="step-5-interpretation-10-pts">Step 5: Interpretation (10 pts)</h2>
<p><em>Interpret your results from your visualizations, including the scatter plot, line chart and column chart. Is there an obvious relationship between development and democracy? Do the data generally support Lipset’s theory?</em></p>
<p>I believe that the data does generally support Lipset’s theory because there is a slight correlation between development and democracy.</p>
</section>
<section id="step-6-rendering-10-pts" class="level2">
<h2 class="anchored" data-anchor-id="step-6-rendering-10-pts">Step 6: Rendering (10 pts)</h2>
<p><em>Press the render button to create your HTML document. If you get any errors go back and fix them and try again until the document renders.</em></p>
</section>
<section id="extra-credit-3-pts" class="level2">
<h2 class="anchored" data-anchor-id="extra-credit-3-pts">Extra Credit (3 pts)</h2>
<p><em>(a) Use a Quato theme to improve the look of the HTML output.</em></p>
<p><em>(b) Use the <code>paletteer</code> package to a different theme to your scatter plot from Step 4.</em></p>
<p><em>(c) Add annotation to your scatter plot from Step 4 using hline() or vline() to highlight a significant point in your data, like the mean or some other significant value. (Note: you will have to do some research to complete this step–we did not do it in class).</em></p>
</section>
<section id="submission" class="level2">
<h2 class="anchored" data-anchor-id="submission">Submission</h2>
<p><em>After rendering your document, export your project folder and submit it on Blackboard. You will find the link to the Coding Assignment one submission portal under the Assignments link. There are instructions along with screenshots there to assist you with the process of exporting your project as a ZIP file from Posit Cloud.</em></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>